
#include "s_gfx/mono_fonts.h"
#include "s_util/str.h"
#include "s_util/misc.h"
#include <stdint.h>

// Each character is defined by 8 bytes (one per row)
// Each byte represents a 5-pixel wide row (bits 7-3 are used)
// Bit pattern: 0bXXXXX000 where leftmost bit (bit 7) = leftmost pixel
// Pixels are left-aligned in the byte: bit7, bit6, bit5, bit4, bit3 = pixels 1-5

#define ASCII_MONO_8X8_UNKNOWN {0xF8, 0x88, 0x88, 0x88, 0x88, 0x88, 0xF8, 0x00}

/**
 * A good ol' 8x8 monospace font generated by deepseek.
 */
static const uint8_t ASCII_MONO_8X8_BITMAPS[128][8] = {
    // ASCII 0-31: Control characters (mostly empty)
    ASCII_MONO_8X8_UNKNOWN, // 0 NUL
    ASCII_MONO_8X8_UNKNOWN, // 1 SOH
    ASCII_MONO_8X8_UNKNOWN, // 2 STX
    ASCII_MONO_8X8_UNKNOWN, // 3 ETX
    ASCII_MONO_8X8_UNKNOWN, // 4 EOT
    ASCII_MONO_8X8_UNKNOWN, // 5 ENQ
    ASCII_MONO_8X8_UNKNOWN, // 6 ACK
    ASCII_MONO_8X8_UNKNOWN, // 7 BEL
    ASCII_MONO_8X8_UNKNOWN, // 8 BS
    ASCII_MONO_8X8_UNKNOWN, // 9 TAB
    ASCII_MONO_8X8_UNKNOWN, // 10 LF
    ASCII_MONO_8X8_UNKNOWN, // 11 VT
    ASCII_MONO_8X8_UNKNOWN, // 12 FF
    ASCII_MONO_8X8_UNKNOWN, // 13 CR
    ASCII_MONO_8X8_UNKNOWN, // 14 SO
    ASCII_MONO_8X8_UNKNOWN, // 15 SI
    ASCII_MONO_8X8_UNKNOWN, // 16 DLE
    ASCII_MONO_8X8_UNKNOWN, // 17 DC1
    ASCII_MONO_8X8_UNKNOWN, // 18 DC2
    ASCII_MONO_8X8_UNKNOWN, // 19 DC3
    ASCII_MONO_8X8_UNKNOWN, // 20 DC4
    ASCII_MONO_8X8_UNKNOWN, // 21 NAK
    ASCII_MONO_8X8_UNKNOWN, // 22 SYN
    ASCII_MONO_8X8_UNKNOWN, // 23 ETB
    ASCII_MONO_8X8_UNKNOWN, // 24 CAN
    ASCII_MONO_8X8_UNKNOWN, // 25 EM
    ASCII_MONO_8X8_UNKNOWN, // 26 SUB
    ASCII_MONO_8X8_UNKNOWN, // 27 ESC
    ASCII_MONO_8X8_UNKNOWN, // 28 FS
    ASCII_MONO_8X8_UNKNOWN, // 29 GS
    ASCII_MONO_8X8_UNKNOWN, // 30 RS
    ASCII_MONO_8X8_UNKNOWN, // 31 US
    
    {0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00}, // 32 ' '
    {0x20, 0x20, 0x20, 0x20, 0x00, 0x00, 0x20, 0x00}, // 33 '!'
    {0x50, 0x50, 0x50, 0x00, 0x00, 0x00, 0x00, 0x00}, // 34 '"'
    {0x50, 0x50, 0xF8, 0x50, 0xF8, 0x50, 0x50, 0x00}, // 35 '#'
    {0x20, 0x78, 0xA0, 0x70, 0x28, 0xF0, 0x20, 0x00}, // 36 '$'
    {0xC0, 0xC8, 0x10, 0x20, 0x40, 0x98, 0x18, 0x00}, // 37 '%'
    {0x60, 0x90, 0xA0, 0x40, 0xA8, 0x90, 0x68, 0x00}, // 38 '&'
    {0x60, 0x20, 0x40, 0x00, 0x00, 0x00, 0x00, 0x00}, // 39 '''
    {0x10, 0x20, 0x40, 0x40, 0x40, 0x20, 0x10, 0x00}, // 40 '('
    {0x40, 0x20, 0x10, 0x10, 0x10, 0x20, 0x40, 0x00}, // 41 ')'
    {0x00, 0x20, 0xA8, 0x70, 0xA8, 0x20, 0x00, 0x00}, // 42 '*'
    {0x00, 0x20, 0x20, 0xF8, 0x20, 0x20, 0x00, 0x00}, // 43 '+'
    {0x00, 0x00, 0x00, 0x00, 0x60, 0x20, 0x40, 0x00}, // 44 ','
    {0x00, 0x00, 0x00, 0xF8, 0x00, 0x00, 0x00, 0x00}, // 45 '-'
    {0x00, 0x00, 0x00, 0x00, 0x00, 0x60, 0x60, 0x00}, // 46 '.'
    {0x00, 0x08, 0x10, 0x20, 0x40, 0x80, 0x00, 0x00}, // 47 '/'
    {0x70, 0x88, 0x98, 0xA8, 0xC8, 0x88, 0x70, 0x00}, // 48 '0'
    {0x20, 0x60, 0x20, 0x20, 0x20, 0x20, 0x70, 0x00}, // 49 '1'
    {0x70, 0x88, 0x08, 0x10, 0x20, 0x40, 0xF8, 0x00}, // 50 '2'
    {0xF8, 0x10, 0x20, 0x10, 0x08, 0x88, 0x70, 0x00}, // 51 '3'
    {0x10, 0x30, 0x50, 0x90, 0xF8, 0x10, 0x10, 0x00}, // 52 '4'
    {0xF8, 0x80, 0xF0, 0x08, 0x08, 0x88, 0x70, 0x00}, // 53 '5'
    {0x30, 0x40, 0x80, 0xF0, 0x88, 0x88, 0x70, 0x00}, // 54 '6'
    {0xF8, 0x08, 0x10, 0x20, 0x40, 0x40, 0x40, 0x00}, // 55 '7'
    {0x70, 0x88, 0x88, 0x70, 0x88, 0x88, 0x70, 0x00}, // 56 '8'
    {0x70, 0x88, 0x88, 0x78, 0x08, 0x10, 0x60, 0x00}, // 57 '9'
    {0x00, 0x60, 0x60, 0x00, 0x60, 0x60, 0x00, 0x00}, // 58 ':'
    {0x00, 0x60, 0x60, 0x00, 0x60, 0x20, 0x40, 0x00}, // 59 ';'
    {0x10, 0x20, 0x40, 0x80, 0x40, 0x20, 0x10, 0x00}, // 60 '<'
    {0x00, 0x00, 0xF8, 0x00, 0xF8, 0x00, 0x00, 0x00}, // 61 '='
    {0x40, 0x20, 0x10, 0x08, 0x10, 0x20, 0x40, 0x00}, // 62 '>'
    {0x70, 0x88, 0x08, 0x10, 0x20, 0x00, 0x20, 0x00}, // 63 '?'
    {0x70, 0x88, 0x08, 0x68, 0xA8, 0xA8, 0x70, 0x00}, // 64 '@'
    {0x20, 0x50, 0x88, 0x88, 0xF8, 0x88, 0x88, 0x00}, // 65 'A'
    {0xF0, 0x88, 0x88, 0xF0, 0x88, 0x88, 0xF0, 0x00}, // 66 'B'
    {0x70, 0x88, 0x80, 0x80, 0x80, 0x88, 0x70, 0x00}, // 67 'C'
    {0xF0, 0x88, 0x88, 0x88, 0x88, 0x88, 0xF0, 0x00}, // 68 'D'
    {0xF8, 0x80, 0x80, 0xF0, 0x80, 0x80, 0xF8, 0x00}, // 69 'E'
    {0xF8, 0x80, 0x80, 0xF0, 0x80, 0x80, 0x80, 0x00}, // 70 'F'
    {0x70, 0x88, 0x80, 0xB8, 0x88, 0x88, 0x78, 0x00}, // 71 'G'
    {0x88, 0x88, 0x88, 0xF8, 0x88, 0x88, 0x88, 0x00}, // 72 'H'
    {0x70, 0x20, 0x20, 0x20, 0x20, 0x20, 0x70, 0x00}, // 73 'I'
    {0x38, 0x10, 0x10, 0x10, 0x10, 0x90, 0x60, 0x00}, // 74 'J'
    {0x88, 0x90, 0xA0, 0xC0, 0xA0, 0x90, 0x88, 0x00}, // 75 'K'
    {0x80, 0x80, 0x80, 0x80, 0x80, 0x80, 0xF8, 0x00}, // 76 'L'
    {0x88, 0xD8, 0xA8, 0xA8, 0x88, 0x88, 0x88, 0x00}, // 77 'M'
    {0x88, 0xC8, 0xC8, 0xA8, 0x98, 0x98, 0x88, 0x00}, // 78 'N'
    {0x70, 0x88, 0x88, 0x88, 0x88, 0x88, 0x70, 0x00}, // 79 'O'
    {0xF0, 0x88, 0x88, 0xF0, 0x80, 0x80, 0x80, 0x00}, // 80 'P'
    {0x70, 0x88, 0x88, 0x88, 0xA8, 0x90, 0x68, 0x00}, // 81 'Q'
    {0xF0, 0x88, 0x88, 0xF0, 0xA0, 0x90, 0x88, 0x00}, // 82 'R'
    {0x78, 0x80, 0x80, 0x70, 0x08, 0x08, 0xF0, 0x00}, // 83 'S'
    {0xF8, 0x20, 0x20, 0x20, 0x20, 0x20, 0x20, 0x00}, // 84 'T'
    {0x88, 0x88, 0x88, 0x88, 0x88, 0x88, 0x70, 0x00}, // 85 'U'
    {0x88, 0x88, 0x88, 0x88, 0x88, 0x50, 0x20, 0x00}, // 86 'V'
    {0x88, 0x88, 0x88, 0xA8, 0xA8, 0xD8, 0x88, 0x00}, // 87 'W'
    {0x88, 0x88, 0x50, 0x20, 0x50, 0x88, 0x88, 0x00}, // 88 'X'
    {0x88, 0x88, 0x50, 0x20, 0x20, 0x20, 0x20, 0x00}, // 89 'Y'
    {0xF8, 0x08, 0x10, 0x20, 0x40, 0x80, 0xF8, 0x00}, // 90 'Z'
    {0x70, 0x40, 0x40, 0x40, 0x40, 0x40, 0x70, 0x00}, // 91 '['
    {0x00, 0x80, 0x40, 0x20, 0x10, 0x08, 0x00, 0x00}, // 92 '\'
    {0x70, 0x10, 0x10, 0x10, 0x10, 0x10, 0x70, 0x00}, // 93 ']'
    {0x20, 0x50, 0x88, 0x00, 0x00, 0x00, 0x00, 0x00}, // 94 '^'
    {0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0xF8, 0x00}, // 95 '_'
    {0x40, 0x20, 0x10, 0x00, 0x00, 0x00, 0x00, 0x00}, // 96 '`'
    {0x00, 0x00, 0x70, 0x08, 0x78, 0x88, 0x78, 0x00}, // 97 'a'
    {0x80, 0x80, 0xB0, 0xC8, 0x88, 0x88, 0xF0, 0x00}, // 98 'b'
    {0x00, 0x00, 0x70, 0x80, 0x80, 0x88, 0x70, 0x00}, // 99 'c'
    {0x08, 0x08, 0x68, 0x98, 0x88, 0x88, 0x78, 0x00}, // 100 'd'
    {0x00, 0x00, 0x70, 0x88, 0xF8, 0x80, 0x70, 0x00}, // 101 'e'
    {0x30, 0x48, 0x40, 0xE0, 0x40, 0x40, 0x40, 0x00}, // 102 'f'
    {0x00, 0x78, 0x88, 0x88, 0x78, 0x08, 0x70, 0x00}, // 103 'g'
    {0x80, 0x80, 0xB0, 0xC8, 0x88, 0x88, 0x88, 0x00}, // 104 'h'
    {0x20, 0x00, 0x60, 0x20, 0x20, 0x20, 0x70, 0x00}, // 105 'i'
    {0x10, 0x00, 0x30, 0x10, 0x10, 0x90, 0x60, 0x00}, // 106 'j'
    {0x80, 0x80, 0x90, 0xA0, 0xC0, 0xA0, 0x90, 0x00}, // 107 'k'
    {0x60, 0x20, 0x20, 0x20, 0x20, 0x20, 0x70, 0x00}, // 108 'l'
    {0x00, 0x00, 0xD0, 0xA8, 0xA8, 0xA8, 0xA8, 0x00}, // 109 'm'
    {0x00, 0x00, 0xB0, 0xC8, 0x88, 0x88, 0x88, 0x00}, // 110 'n'
    {0x00, 0x00, 0x70, 0x88, 0x88, 0x88, 0x70, 0x00}, // 111 'o'
    {0x00, 0x00, 0xF0, 0x88, 0xF0, 0x80, 0x80, 0x00}, // 112 'p'
    {0x00, 0x00, 0x68, 0x98, 0x78, 0x08, 0x08, 0x00}, // 113 'q'
    {0x00, 0x00, 0xB0, 0xC8, 0x80, 0x80, 0x80, 0x00}, // 114 'r'
    {0x00, 0x00, 0x70, 0x80, 0x70, 0x08, 0xF0, 0x00}, // 115 's'
    {0x40, 0x40, 0xE0, 0x40, 0x40, 0x48, 0x30, 0x00}, // 116 't'
    {0x00, 0x00, 0x88, 0x88, 0x88, 0x98, 0x68, 0x00}, // 117 'u'
    {0x00, 0x00, 0x88, 0x88, 0x88, 0x50, 0x20, 0x00}, // 118 'v'
    {0x00, 0x00, 0x88, 0x88, 0xA8, 0xA8, 0x50, 0x00}, // 119 'w'
    {0x00, 0x00, 0x88, 0x50, 0x20, 0x50, 0x88, 0x00}, // 120 'x'
    {0x00, 0x00, 0x88, 0x88, 0x78, 0x08, 0x70, 0x00}, // 121 'y'
    {0x00, 0x00, 0xF8, 0x10, 0x20, 0x40, 0xF8, 0x00}, // 122 'z'
    {0x10, 0x20, 0x20, 0x40, 0x20, 0x20, 0x10, 0x00}, // 123 '{'
    {0x20, 0x20, 0x20, 0x20, 0x20, 0x20, 0x20, 0x00}, // 124 '|'
    {0x40, 0x20, 0x20, 0x10, 0x20, 0x20, 0x40, 0x00}, // 125 '}'
    {0x00, 0x00, 0x00, 0x68, 0x90, 0x00, 0x00, 0x00}, // 126 '~'

    // ASCII 127: DEL
    ASCII_MONO_8X8_UNKNOWN  // 127 DEL
};

static const ascii_mono_font_t ASCII_MONO_8X8_VAL = {
    .char_width = 8,
    .char_height = 8,
    .bitmaps = (uint8_t *)ASCII_MONO_8X8_BITMAPS
};

const ascii_mono_font_t * const ASCII_MONO_8X8 = &ASCII_MONO_8X8_VAL;


#define ASCII_MONO_8X16_UNKNOWN \
{ \
    0x00, 0x00, 0xFE, 0x82, \
    0x82, 0x82, 0x82, 0x82, \
    0x82, 0x82, 0x82, 0xFE, \
    0x00, 0x00, 0x00, 0x00, \
}

/**
 * An 8x16 Font generated by deepseek. Much better than th 8x8 font tbh.
 */
const uint8_t ASCII_MONO_8X16_BITMAPS[128][16] = {
    // ASCII 0-15
    ASCII_MONO_8X16_UNKNOWN, // 0
    ASCII_MONO_8X16_UNKNOWN, // 1
    ASCII_MONO_8X16_UNKNOWN, // 2
    ASCII_MONO_8X16_UNKNOWN, // 3
    ASCII_MONO_8X16_UNKNOWN, // 4
    ASCII_MONO_8X16_UNKNOWN, // 5
    ASCII_MONO_8X16_UNKNOWN, // 6
    ASCII_MONO_8X16_UNKNOWN, // 7
    ASCII_MONO_8X16_UNKNOWN, // 8
    ASCII_MONO_8X16_UNKNOWN, // 9
    ASCII_MONO_8X16_UNKNOWN, // 10
    ASCII_MONO_8X16_UNKNOWN, // 11
    ASCII_MONO_8X16_UNKNOWN, // 12
    ASCII_MONO_8X16_UNKNOWN, // 13
    ASCII_MONO_8X16_UNKNOWN, // 14
    ASCII_MONO_8X16_UNKNOWN, // 15
    
    // ASCII 16-31
    ASCII_MONO_8X16_UNKNOWN, // 16
    ASCII_MONO_8X16_UNKNOWN, // 17
    ASCII_MONO_8X16_UNKNOWN, // 18
    ASCII_MONO_8X16_UNKNOWN, // 19
    ASCII_MONO_8X16_UNKNOWN, // 20
    ASCII_MONO_8X16_UNKNOWN, // 21
    ASCII_MONO_8X16_UNKNOWN, // 22
    ASCII_MONO_8X16_UNKNOWN, // 23
    ASCII_MONO_8X16_UNKNOWN, // 24
    ASCII_MONO_8X16_UNKNOWN, // 25
    ASCII_MONO_8X16_UNKNOWN, // 26
    ASCII_MONO_8X16_UNKNOWN, // 27
    ASCII_MONO_8X16_UNKNOWN, // 28
    ASCII_MONO_8X16_UNKNOWN, // 29
    ASCII_MONO_8X16_UNKNOWN, // 30
    ASCII_MONO_8X16_UNKNOWN, // 31
    
    // ASCII 32-47 (Space, !, ", #, $, %, &, ', (, ), *, +, comma, -, ., /)
    {0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00}, // 32 (Space)
    {0x00,0x00,0x18,0x3C,0x3C,0x3C,0x18,0x18,0x18,0x00,0x18,0x18,0x00,0x00,0x00,0x00}, // 33 (!)
    {0x00,0x66,0x66,0x66,0x24,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00}, // 34 (")
    {0x00,0x00,0x00,0x6C,0x6C,0xFE,0x6C,0x6C,0x6C,0xFE,0x6C,0x6C,0x00,0x00,0x00,0x00}, // 35 (#)
    {0x18,0x18,0x7C,0xC6,0xC2,0xC0,0x7C,0x06,0x06,0x86,0xC6,0x7C,0x18,0x18,0x00,0x00}, // 36 ($)
    {0x00,0x00,0x00,0x00,0xC2,0xC6,0x0C,0x18,0x30,0x60,0xC6,0x86,0x00,0x00,0x00,0x00}, // 37 (%)
    {0x00,0x00,0x38,0x6C,0x6C,0x38,0x76,0xDC,0xCC,0xCC,0xCC,0x76,0x00,0x00,0x00,0x00}, // 38 (&)
    {0x00,0x30,0x30,0x30,0x60,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00}, // 39 (')
    {0x00,0x00,0x0C,0x18,0x30,0x30,0x30,0x30,0x30,0x30,0x18,0x0C,0x00,0x00,0x00,0x00}, // 40 (()
    {0x00,0x00,0x30,0x18,0x0C,0x0C,0x0C,0x0C,0x0C,0x0C,0x18,0x30,0x00,0x00,0x00,0x00}, // 41 ())
    {0x00,0x00,0x00,0x00,0x00,0x66,0x3C,0xFF,0x3C,0x66,0x00,0x00,0x00,0x00,0x00,0x00}, // 42 (*)
    {0x00,0x00,0x00,0x00,0x00,0x18,0x18,0x7E,0x18,0x18,0x00,0x00,0x00,0x00,0x00,0x00}, // 43 (+)
    {0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x18,0x18,0x18,0x30,0x00,0x00,0x00}, // 44 (,)
    {0x00,0x00,0x00,0x00,0x00,0x00,0x00,0xFE,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00}, // 45 (-)
    {0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x18,0x18,0x00,0x00,0x00,0x00}, // 46 (.)
    {0x00,0x00,0x00,0x00,0x02,0x06,0x0C,0x18,0x30,0x60,0xC0,0x80,0x00,0x00,0x00,0x00}, // 47 (/)
    
    // ASCII 48-57 (0-9)
    {0x00,0x00,0x7C,0xC6,0xC6,0xCE,0xDE,0xF6,0xE6,0xC6,0xC6,0x7C,0x00,0x00,0x00,0x00}, // 48 (0)
    {0x00,0x00,0x18,0x38,0x78,0x18,0x18,0x18,0x18,0x18,0x18,0x7E,0x00,0x00,0x00,0x00}, // 49 (1)
    {0x00,0x00,0x7C,0xC6,0x06,0x0C,0x18,0x30,0x60,0xC0,0xC6,0xFE,0x00,0x00,0x00,0x00}, // 50 (2)
    {0x00,0x00,0x7C,0xC6,0x06,0x06,0x3C,0x06,0x06,0x06,0xC6,0x7C,0x00,0x00,0x00,0x00}, // 51 (3)
    {0x00,0x00,0x0C,0x1C,0x3C,0x6C,0xCC,0xFE,0x0C,0x0C,0x0C,0x1E,0x00,0x00,0x00,0x00}, // 52 (4)
    {0x00,0x00,0xFE,0xC0,0xC0,0xC0,0xFC,0x06,0x06,0x06,0xC6,0x7C,0x00,0x00,0x00,0x00}, // 53 (5)
    {0x00,0x00,0x38,0x60,0xC0,0xC0,0xFC,0xC6,0xC6,0xC6,0xC6,0x7C,0x00,0x00,0x00,0x00}, // 54 (6)
    {0x00,0x00,0xFE,0xC6,0x06,0x06,0x0C,0x18,0x30,0x30,0x30,0x30,0x00,0x00,0x00,0x00}, // 55 (7)
    {0x00,0x00,0x7C,0xC6,0xC6,0xC6,0x7C,0xC6,0xC6,0xC6,0xC6,0x7C,0x00,0x00,0x00,0x00}, // 56 (8)
    {0x00,0x00,0x7C,0xC6,0xC6,0xC6,0x7E,0x06,0x06,0x06,0x0C,0x78,0x00,0x00,0x00,0x00}, // 57 (9)
    
    // ASCII 58-64 (:, ;, <, =, >, ?, @)
    {0x00,0x00,0x00,0x00,0x18,0x18,0x00,0x00,0x00,0x18,0x18,0x00,0x00,0x00,0x00,0x00}, // 58 (:)
    {0x00,0x00,0x00,0x00,0x18,0x18,0x00,0x00,0x00,0x18,0x18,0x30,0x00,0x00,0x00,0x00}, // 59 (;)
    {0x00,0x00,0x00,0x06,0x0C,0x18,0x30,0x60,0x30,0x18,0x0C,0x06,0x00,0x00,0x00,0x00}, // 60 (<)
    {0x00,0x00,0x00,0x00,0x00,0x7E,0x00,0x00,0x7E,0x00,0x00,0x00,0x00,0x00,0x00,0x00}, // 61 (=)
    {0x00,0x00,0x00,0x60,0x30,0x18,0x0C,0x06,0x0C,0x18,0x30,0x60,0x00,0x00,0x00,0x00}, // 62 (>)
    {0x00,0x00,0x7C,0xC6,0xC6,0x0C,0x18,0x18,0x18,0x00,0x18,0x18,0x00,0x00,0x00,0x00}, // 63 (?)
    {0x00,0x00,0x7C,0xC6,0xC6,0xDE,0xDE,0xDE,0xDE,0xDE,0xC0,0x7E,0x00,0x00,0x00,0x00}, // 64 (@)
    
    // ASCII 65-90 (A-Z)
    {0x00,0x00,0x10,0x38,0x6C,0xC6,0xC6,0xFE,0xC6,0xC6,0xC6,0xC6,0x00,0x00,0x00,0x00}, // 65 (A)
    {0x00,0x00,0xFC,0x66,0x66,0x66,0x7C,0x66,0x66,0x66,0x66,0xFC,0x00,0x00,0x00,0x00}, // 66 (B)
    {0x00,0x00,0x3C,0x66,0xC2,0xC0,0xC0,0xC0,0xC0,0xC2,0x66,0x3C,0x00,0x00,0x00,0x00}, // 67 (C)
    {0x00,0x00,0xF8,0x6C,0x66,0x66,0x66,0x66,0x66,0x66,0x6C,0xF8,0x00,0x00,0x00,0x00}, // 68 (D)
    {0x00,0x00,0xFE,0x66,0x62,0x68,0x78,0x68,0x60,0x62,0x66,0xFE,0x00,0x00,0x00,0x00}, // 69 (E)
    {0x00,0x00,0xFE,0x66,0x62,0x68,0x78,0x68,0x60,0x60,0x60,0xF0,0x00,0x00,0x00,0x00}, // 70 (F)
    {0x00,0x00,0x3C,0x66,0xC2,0xC0,0xC0,0xDE,0xC6,0xC6,0x66,0x3A,0x00,0x00,0x00,0x00}, // 71 (G)
    {0x00,0x00,0xC6,0xC6,0xC6,0xC6,0xFE,0xC6,0xC6,0xC6,0xC6,0xC6,0x00,0x00,0x00,0x00}, // 72 (H)
    {0x00,0x00,0x3C,0x18,0x18,0x18,0x18,0x18,0x18,0x18,0x18,0x3C,0x00,0x00,0x00,0x00}, // 73 (I)
    {0x00,0x00,0x1E,0x0C,0x0C,0x0C,0x0C,0x0C,0xCC,0xCC,0xCC,0x78,0x00,0x00,0x00,0x00}, // 74 (J)
    {0x00,0x00,0xE6,0x66,0x66,0x6C,0x78,0x78,0x6C,0x66,0x66,0xE6,0x00,0x00,0x00,0x00}, // 75 (K)
    {0x00,0x00,0xF0,0x60,0x60,0x60,0x60,0x60,0x60,0x62,0x66,0xFE,0x00,0x00,0x00,0x00}, // 76 (L)
    {0x00,0x00,0xC6,0xEE,0xFE,0xFE,0xD6,0xC6,0xC6,0xC6,0xC6,0xC6,0x00,0x00,0x00,0x00}, // 77 (M)
    {0x00,0x00,0xC6,0xE6,0xF6,0xFE,0xDE,0xCE,0xC6,0xC6,0xC6,0xC6,0x00,0x00,0x00,0x00}, // 78 (N)
    {0x00,0x00,0x7C,0xC6,0xC6,0xC6,0xC6,0xC6,0xC6,0xC6,0xC6,0x7C,0x00,0x00,0x00,0x00}, // 79 (O)
    {0x00,0x00,0xFC,0x66,0x66,0x66,0x7C,0x60,0x60,0x60,0x60,0xF0,0x00,0x00,0x00,0x00}, // 80 (P)
    {0x00,0x00,0x7C,0xC6,0xC6,0xC6,0xC6,0xC6,0xC6,0xD6,0xDE,0x7C,0x0C,0x0E,0x00,0x00}, // 81 (Q)
    {0x00,0x00,0xFC,0x66,0x66,0x66,0x7C,0x6C,0x66,0x66,0x66,0xE6,0x00,0x00,0x00,0x00}, // 82 (R)
    {0x00,0x00,0x7C,0xC6,0xC6,0x60,0x38,0x0C,0x06,0xC6,0xC6,0x7C,0x00,0x00,0x00,0x00}, // 83 (S)
    {0x00,0x00,0x7E,0x7E,0x5A,0x18,0x18,0x18,0x18,0x18,0x18,0x3C,0x00,0x00,0x00,0x00}, // 84 (T)
    {0x00,0x00,0xC6,0xC6,0xC6,0xC6,0xC6,0xC6,0xC6,0xC6,0xC6,0x7C,0x00,0x00,0x00,0x00}, // 85 (U)
    {0x00,0x00,0xC6,0xC6,0xC6,0xC6,0xC6,0xC6,0xC6,0x6C,0x38,0x10,0x00,0x00,0x00,0x00}, // 86 (V)
    {0x00,0x00,0xC6,0xC6,0xC6,0xC6,0xD6,0xD6,0xD6,0xFE,0xEE,0x6C,0x00,0x00,0x00,0x00}, // 87 (W)
    {0x00,0x00,0xC6,0xC6,0x6C,0x7C,0x38,0x38,0x7C,0x6C,0xC6,0xC6,0x00,0x00,0x00,0x00}, // 88 (X)
    {0x00,0x00,0x66,0x66,0x66,0x66,0x3C,0x18,0x18,0x18,0x18,0x3C,0x00,0x00,0x00,0x00}, // 89 (Y)
    {0x00,0x00,0xFE,0xC6,0x86,0x0C,0x18,0x30,0x60,0xC2,0xC6,0xFE,0x00,0x00,0x00,0x00}, // 90 (Z)
    
    // ASCII 91-96 ([, \, ], ^, _, `)
    {0x00,0x00,0x3C,0x30,0x30,0x30,0x30,0x30,0x30,0x30,0x30,0x3C,0x00,0x00,0x00,0x00}, // 91 ([)
    {0x00,0x00,0x00,0x80,0xC0,0xE0,0x70,0x38,0x1C,0x0E,0x06,0x02,0x00,0x00,0x00,0x00}, // 92 (\)
    {0x00,0x00,0x3C,0x0C,0x0C,0x0C,0x0C,0x0C,0x0C,0x0C,0x0C,0x3C,0x00,0x00,0x00,0x00}, // 93 (])
    {0x10,0x38,0x6C,0xC6,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00}, // 94 (^)
    {0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0xFF,0x00,0x00}, // 95 (_)
    {0x30,0x30,0x18,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00}, // 96 (`)
    
    // ASCII 97-122 (a-z)
    {0x00,0x00,0x00,0x00,0x00,0x78,0x0C,0x7C,0xCC,0xCC,0xCC,0x76,0x00,0x00,0x00,0x00}, // 97 (a)
    {0x00,0x00,0xE0,0x60,0x60,0x78,0x6C,0x66,0x66,0x66,0x66,0x7C,0x00,0x00,0x00,0x00}, // 98 (b)
    {0x00,0x00,0x00,0x00,0x00,0x7C,0xC6,0xC0,0xC0,0xC0,0xC6,0x7C,0x00,0x00,0x00,0x00}, // 99 (c)
    {0x00,0x00,0x1C,0x0C,0x0C,0x3C,0x6C,0xCC,0xCC,0xCC,0xCC,0x76,0x00,0x00,0x00,0x00}, // 100 (d)
    {0x00,0x00,0x00,0x00,0x00,0x7C,0xC6,0xFE,0xC0,0xC0,0xC6,0x7C,0x00,0x00,0x00,0x00}, // 101 (e)
    {0x00,0x00,0x38,0x6C,0x64,0x60,0xF0,0x60,0x60,0x60,0x60,0xF0,0x00,0x00,0x00,0x00}, // 102 (f)
    {0x00,0x00,0x00,0x00,0x00,0x76,0xCC,0xCC,0xCC,0xCC,0xCC,0x7C,0x0C,0xCC,0x78,0x00}, // 103 (g)
    {0x00,0x00,0xE0,0x60,0x60,0x6C,0x76,0x66,0x66,0x66,0x66,0xE6,0x00,0x00,0x00,0x00}, // 104 (h)
    {0x00,0x00,0x18,0x18,0x00,0x38,0x18,0x18,0x18,0x18,0x18,0x3C,0x00,0x00,0x00,0x00}, // 105 (i)
    {0x00,0x00,0x06,0x06,0x00,0x0E,0x06,0x06,0x06,0x06,0x06,0x06,0x66,0x66,0x3C,0x00}, // 106 (j)
    {0x00,0x00,0xE0,0x60,0x60,0x66,0x6C,0x78,0x78,0x6C,0x66,0xE6,0x00,0x00,0x00,0x00}, // 107 (k)
    {0x00,0x00,0x38,0x18,0x18,0x18,0x18,0x18,0x18,0x18,0x18,0x3C,0x00,0x00,0x00,0x00}, // 108 (l)
    {0x00,0x00,0x00,0x00,0x00,0xEC,0xFE,0xD6,0xD6,0xD6,0xD6,0xC6,0x00,0x00,0x00,0x00}, // 109 (m)
    {0x00,0x00,0x00,0x00,0x00,0xDC,0x66,0x66,0x66,0x66,0x66,0x66,0x00,0x00,0x00,0x00}, // 110 (n)
    {0x00,0x00,0x00,0x00,0x00,0x7C,0xC6,0xC6,0xC6,0xC6,0xC6,0x7C,0x00,0x00,0x00,0x00}, // 111 (o)
    {0x00,0x00,0x00,0x00,0x00,0xDC,0x66,0x66,0x66,0x66,0x66,0x7C,0x60,0x60,0xF0,0x00}, // 112 (p)
    {0x00,0x00,0x00,0x00,0x00,0x76,0xCC,0xCC,0xCC,0xCC,0xCC,0x7C,0x0C,0x0C,0x1E,0x00}, // 113 (q)
    {0x00,0x00,0x00,0x00,0x00,0xDC,0x76,0x66,0x60,0x60,0x60,0xF0,0x00,0x00,0x00,0x00}, // 114 (r)
    {0x00,0x00,0x00,0x00,0x00,0x7C,0xC6,0x60,0x38,0x0C,0xC6,0x7C,0x00,0x00,0x00,0x00}, // 115 (s)
    {0x00,0x00,0x10,0x30,0x30,0xFC,0x30,0x30,0x30,0x30,0x36,0x1C,0x00,0x00,0x00,0x00}, // 116 (t)
    {0x00,0x00,0x00,0x00,0x00,0xCC,0xCC,0xCC,0xCC,0xCC,0xCC,0x76,0x00,0x00,0x00,0x00}, // 117 (u)
    {0x00,0x00,0x00,0x00,0x00,0x66,0x66,0x66,0x66,0x66,0x3C,0x18,0x00,0x00,0x00,0x00}, // 118 (v)
    {0x00,0x00,0x00,0x00,0x00,0xC6,0xC6,0xD6,0xD6,0xD6,0xFE,0x6C,0x00,0x00,0x00,0x00}, // 119 (w)
    {0x00,0x00,0x00,0x00,0x00,0xC6,0x6C,0x38,0x38,0x38,0x6C,0xC6,0x00,0x00,0x00,0x00}, // 120 (x)
    {0x00,0x00,0x00,0x00,0x00,0xC6,0xC6,0xC6,0xC6,0xC6,0xC6,0x7E,0x06,0x0C,0xF8,0x00}, // 121 (y)
    {0x00,0x00,0x00,0x00,0x00,0xFE,0xCC,0x18,0x30,0x60,0xC6,0xFE,0x00,0x00,0x00,0x00}, // 122 (z)
    
    // ASCII 123-127 ({, |, }, ~)
    {0x00,0x00,0x0E,0x18,0x18,0x18,0x70,0x18,0x18,0x18,0x18,0x0E,0x00,0x00,0x00,0x00}, // 123 ({)
    {0x00,0x00,0x18,0x18,0x18,0x18,0x18,0x18,0x18,0x18,0x18,0x18,0x00,0x00,0x00,0x00}, // 124 (|)
    {0x00,0x00,0x70,0x18,0x18,0x18,0x0E,0x18,0x18,0x18,0x18,0x70,0x00,0x00,0x00,0x00}, // 125 (})
    {0x00,0x00,0x76,0xDC,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00}, // 126 (~)
                                                                                                                                                                   //
    ASCII_MONO_8X16_UNKNOWN  // 127 (DEL)
};

static const ascii_mono_font_t ASCII_MONO_8X16_VAL = {
    .char_width = 8,
    .char_height = 16,
    .bitmaps = (uint8_t *)ASCII_MONO_8X16_BITMAPS
};

const ascii_mono_font_t * const ASCII_MONO_8X16 = &ASCII_MONO_8X16_VAL;

const ascii_mono_font_t * const ASCII_MONO_FONT_MAP[] = {
    [ASCII_MONO_8X8_FMI] = ASCII_MONO_8X8,
    [ASCII_MONO_8X16_FMI] = ASCII_MONO_8X16
};

void gfx_draw_ascii_mono_text(gfx_buffer_t *buf, const gfx_box_t *clip_area,
        const char *str, 
        const ascii_mono_font_t *amf, 
        int32_t x, int32_t y, 
        uint8_t w_scale, uint8_t h_scale,
        gfx_color_t fg_color, gfx_color_t bg_color) {
    // Don't bother if fg and bg are both clear.
    if (gfx_color_is_clear(fg_color) && gfx_color_is_clear(bg_color)) {
        return;
    }

    const size_t amf_bytes_per_row = ((amf->char_width - 1) / 8) + 1;
    const size_t amf_bytes_per_char = amf_bytes_per_row * amf->char_height;

    const uint16_t char_width = w_scale * amf->char_width;
    const uint16_t char_height = h_scale * amf->char_height;

    // This check will happen no matter what by `intervals_overlap`.
    // But I want to prevent a division by 0 when calcing `max_str_len`.
    if (char_width == 0 || char_height == 0) {
        return;
    }

    // We want to make sure that when we calculate the length of the full string in pixels that
    // the qauntity doesn't wrap. So, we'll only consider characters up to a certain length.
    //
    // NOTE: This is a pretty niche case that will likely never happen.
    const uint16_t max_str_len = UINT16_MAX / char_width;
    const size_t slen = str_len(str);

    // sig_len for "significant length" (The only characters we care about).
    const uint16_t sig_len = MIN(slen, max_str_len);

    gfx_box_t render_area = {
        .x = x, .y = y,
        .width = sig_len * char_width,
        .height = char_height
    };

    if (!gfx_clip_with_buffer(buf, clip_area, &render_area)) {
        return;
    }

    const int32_t render_area_end_x = render_area.x + render_area.width - 1;

    // Ok, now we actually determine which characters we actually need to render.
    size_t start_ci = (render_area.x - x) / char_width;
    size_t end_ci = (render_area_end_x - x) / char_width;  // inclusive.

    size_t ci = start_ci;
    int32_t ci_x = x + (start_ci * char_width);
    for (; ci <= end_ci; ci++, ci_x += char_width) {
        char c = str[ci];
        if (c & 0x80U) { // We reduce extension ascii characters to the NT. May change this 
                         // later.
            c = '\0';
        }

        gfx_fill_bitmap(buf, &render_area,
                ci_x, y, w_scale, h_scale, 
                amf->bitmaps + (c * amf_bytes_per_char), 
                amf->char_height, 
                amf->char_width, fg_color, bg_color);
    }
}

static const gfx_ansi_palette_t BASIC_ANSI_PALETTE_VAL = {
    .colors = {
        gfx_color(0, 0, 0), // Black
        gfx_color(0, 0, 180), // Blue
        gfx_color(0, 180, 0), // Green
        gfx_color(0, 180, 180), // Cyan
        gfx_color(180, 0, 0), // Red
        gfx_color(180, 0, 180), // Magenta
        gfx_color(180, 180, 0), // Brown
        gfx_color(180, 180, 180), // Grey

        // Brights
        gfx_color(0, 0, 0), // Black
        gfx_color(0, 0, 255), // Blue
        gfx_color(0, 255, 0), // Green
        gfx_color(0, 255, 255), // Cyan
        gfx_color(255, 0, 0), // Red
        gfx_color(255, 0, 255), // Magenta
        gfx_color(255, 255, 0), // Brown
        gfx_color(255, 255, 255), // Grey
    }
};

const gfx_ansi_palette_t * const BASIC_ANSI_PALETTE = &BASIC_ANSI_PALETTE_VAL;

void gfx_draw_term_buffer(gfx_buffer_t *buf, const gfx_box_t *clip_area,
        const term_buffer_t *curr_tb, const term_buffer_t *next_tb, 
        const ascii_mono_font_t *amf, const gfx_ansi_palette_t *palette,
        int32_t x, int32_t y, uint8_t w_scale, uint8_t h_scale) {

    // Dims much match if `curr_tb` is given.
    if (curr_tb && !(curr_tb->rows == next_tb->rows && curr_tb->cols == next_tb->cols)) {
        return;
    }

    const size_t amf_bytes_per_row = ((amf->char_width - 1) / 8) + 1;
    const size_t amf_bytes_per_char = amf_bytes_per_row * amf->char_height;

    const uint16_t char_width = w_scale * amf->char_width;
    const uint16_t char_height = h_scale * amf->char_height;

    gfx_box_t render_area = {
        .x = x, .y = y,
        .width = char_width * next_tb->cols,
        .height = char_height * next_tb->rows
    };

    if (!gfx_clip_with_buffer(buf, clip_area, &render_area)) {
        return;
    }

    // So, what (r, c) must we start and end at with rendering? 
    const uint16_t start_col = (render_area.x - x) / char_width;
    const uint16_t end_col = (render_area.x + render_area.width - 1 - x) / char_width;

    const uint16_t start_row = (render_area.y - y) / char_height;
    const uint16_t end_row = (render_area.y + render_area.height - 1 - y) / char_height;

    uint32_t cell_ind = (start_row * next_tb->cols) + start_col;
    for (uint16_t r = start_row; r <= end_row; r++) {
        for (uint16_t c = start_col; c <= end_col; c++, cell_ind++) {
            term_cell_t tc = next_tb->buf[cell_ind];
            if (!is_ascii_printable(tc.c)) {
                tc.c = ' ';
            }

            if (!curr_tb || !tc_ascii_printable_equals(curr_tb->buf[cell_ind], tc)) {
                // Render time baby!
                gfx_fill_bitmap(buf, &render_area,
                        x + (c * char_width), 
                        y + (r * char_height), 
                        w_scale, h_scale, 
                        amf->bitmaps + (tc.c * amf_bytes_per_char), 
                        amf->char_height, 
                        amf->char_width, 
                        palette->colors[ts_fg_color(tc.style)], 
                        palette->colors[ts_bg_color(tc.style)]);
            }
        }
    }
}

